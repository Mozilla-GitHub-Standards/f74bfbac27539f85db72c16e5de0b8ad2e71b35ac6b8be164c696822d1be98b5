<!DOCTYPE html>
<html>
<head>
    <title>Test IFrame</title>
    <style type="text/css">
    html, body {
        background-color: gray;
        margin: 0;
        padding: 0;
    }
    iframe {
        height: 128px;
        width: 100%;
        border: 0;
    }
    
    #accountForm textarea {
        width: 50%;
        height: 150px;
    }
    </style>
    <script src="../../scripts/requireplugins-jquery-1.4.2.js" charset="utf-8"></script>
    <script>
        require(["require", "jquery", "blade/fn", "rdapi", "blade/url"],
        function (require,   $,        fn,         rdapi,   url) {
            $(function () {
                var accountForm = $('#accountForm'),
                    iframeNode = $('#shareFrame')[0],
                    shareUrl = 'index.html';
    
                accountForm.bind('submit', function (evt) {
                    var options = JSON.parse(accountForm.find('textarea').val());
                    iframeNode.src = shareUrl +
                        '#options=' + encodeURIComponent(JSON.stringify(options));
                    iframeNode.contentWindow.location.reload(true);
                    evt.preventDefault();
                });
            });
        });
    </script>
</head>
<body>
    <iframe id="shareFrame" src="index.html"></iframe>

<hr>
    <form id="accountForm" action="#">
<br>
    Options:
        <textarea>
{
    "url": "http://mozilla.com",
    "services": {
        "twitter": {
            "usernames": ["mozmotest"]
        }
    }
}
        </textarea>
        <button>Update</button>
    </form>
</body>
</html>
